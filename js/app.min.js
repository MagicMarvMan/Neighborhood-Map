"use strict";function mapsError(){alert("An error occured while loading the Map. Please reload the page and try again/open a issue at https://github.com/MagicMarvMan/Neighborhood-Map/issues.")}function AppViewModel(){var n=this;map=new google.maps.Map(document.getElementById("map"),{zoom:config.map.zoom,center:{lat:config.map.lat,lng:config.map["long"]}}),this.query=ko.observable(defaultQuery),this.locations=ko.observableArray([]),config.locations.forEach(function(o){console.log(o.name),n.locations.push(new Location(o))}),this.list=ko.computed(function(){var o=n.query().toLowerCase();return o?ko.utils.arrayFilter(n.locations(),function(n){var e=n.name.toLowerCase(),t=e.search(o)>=0;return n.isVisible(t),t}):(n.locations().forEach(function(n){n.isVisible(!0)}),n.locations())},n),this.mapElem=document.getElementById("map")}function startBootstrap(){ko.applyBindings(new AppViewModel)}var defaultQuery="",config={locations:[{name:"Roemerberg",lat:50.110421,"long":8.68214},{name:"Main-Tower",lat:50.112557,"long":8.672145},{name:"Goethe-House and Museum",lat:50.111276,"long":8.677586},{name:"Main-Station",lat:50.107726,"long":8.664607},{name:"Senckenberg Natural History Museum",lat:50.117574,"long":8.651723},{name:"The Frankfurt Museum of Modern Art",lat:50.112022,"long":8.68478},{name:"The Old Opera House",lat:50.116046,"long":8.671895},{name:"Zoo Frankfurt",lat:50.116368,"long":8.699447},{name:"St. Paul's Church",lat:50.111228,"long":8.680736},{name:"Palm Garden",lat:50.123133,"long":8.656486}],map:{lat:50.111221,"long":8.682562,zoom:14}},map,allInfowindows=ko.observableArray([]),Location=function(n){var o=this;this.name=n.name,this.lat=Number(n.lat),this["long"]=Number(n["long"]),this.phone="",this.url="",$.getJSON("https://api.foursquare.com/v2/venues/search?client_id=PLTZT1HHN0Q20XAE5TRDFUPJLV3YKW4F5ZA00SJYPVTOHO5B&client_secret=RMJKT5CTWVEIFUEKRSAAF01TTABE53IA2OU4IGA4ZRPL1TBV&v=20171228&ll="+o.lat+","+o["long"]+"&query="+o.name,function(n){console.log(n),n.response.venues[0].url&&(o.url=n.response.venues[0].url),n.response.venues[0].contact.formattedPhone&&(o.phone=n.response.venues[0].contact.formattedPhone)}),console.log("Initialized "+this.name),console.log("Lat: "+this.lat),console.log("Long: "+this["long"]),this.isVisible=ko.observable(!0),this.windowContent='<div class="infwindowcon"><span class="tit"><b>'+n.name+'</b></span><br><a href="'+o.url+'" target="_blank">'+o.url+"</a><br>"+o.phone+"</div>",this.infoWindow=new google.maps.InfoWindow({content:o.windowContent}),allInfowindows().push(o.infoWindow),this.marker=new google.maps.Marker({position:{lat:Number(o.lat),lng:Number(o["long"])},map:map,title:o.name}),this.toggleMarker=ko.computed(function(){return this.isVisible()===!0?this.marker.setMap(map):this.marker.setMap(null),!0},this),this.marker.addListener("click",function(){allInfowindows().forEach(function(n){n.close()}),o.contentString='<div class="infwindowcon"><span class="tit"><b>'+n.name+"</b></span></div>",o.infoWindow.setContent(o.contentString),o.infoWindow.open(map,this),o.marker.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){o.marker.setAnimation(null)},2100)}),this.bounceMarker=function(n){google.maps.event.trigger(o.marker,"click")},this.toggleMarker()};